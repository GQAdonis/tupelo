// RUN `go generate` in this directory when updating the service.proto. Requires the protoc command to be in your path.
syntax = "proto3";
package walletrpc;

option go_package = "walletrpc";

message SerializableSignature {
  repeated bool signers = 1;
  bytes signature = 2;
  string type = 3;
}

message SerializableChainTree {
  repeated bytes dag = 1;
  map<string, SerializableSignature> signatures = 2;
}

message RegisterWalletRequest {
}

message RegisterWalletResponse {
  string wallet_name = 1;
}

message GenerateChainRequest {
  string key_addr = 1;
}

message GenerateChainResponse {
  string chain_id = 1;
}

message ExportChainRequest {
  string chain_id = 1;
}

message ExportChainResponse {
  bytes chain_tree = 1;
}

message ImportChainRequest {
  string key_addr = 1;
  bytes chain_tree = 2;
}

message ImportChainResponse {
  string chain_id = 1;
}

message GenerateKeyRequest {
}

message GenerateKeyResponse {
  string key_addr = 1;
}

message GetTipRequest {
  string chain_id = 1;
}

message GetTipResponse {
  string tip = 1;
}

message ListChainIdsRequest {
}

message ListChainIdsResponse {
  repeated string chain_ids = 1;
}

message ListKeysRequest {
}

message ListKeysResponse {
  repeated string key_addrs = 1;
}

message SetOwnerRequest {
  string chain_id = 1;
  string key_addr = 2;
  repeated string new_owner_keys = 3;
}

message SetOwnerResponse {
  string tip = 1;
}

message SetDataRequest {
  string chain_id = 1;
  string key_addr = 2;
  string path = 3;
  bytes value = 4;
}

message SetDataResponse {
  string tip = 1;
}

message ResolveRequest {
  string chain_id = 1;
  string path = 2;
}

message ResolveResponse {
  string remaining_path = 1;
  bytes data = 2;
}

message EstablishCoinRequest {
  string chain_id = 1;
  string key_addr = 2;
  string coin_name = 3;
  uint64 maximum = 4;
}

message EstablishCoinResponse {
  string tip = 1;
}

message MintCoinRequest {
  string chain_id = 1;
  string key_addr = 2;
  string coin_name = 3;
  uint64 amount = 4;
}

message MintCoinResponse {
  string tip = 1;
}

service WalletRPCService {
  rpc Register (RegisterWalletRequest) returns (RegisterWalletResponse);
  rpc GenerateKey (GenerateKeyRequest) returns (GenerateKeyResponse);
  rpc CreateChainTree (GenerateChainRequest) returns (GenerateChainResponse);
  rpc ExportChainTree (ExportChainRequest) returns (ExportChainResponse);
  rpc ImportChainTree (ImportChainRequest) returns (ImportChainResponse);
  rpc GetTip (GetTipRequest) returns (GetTipResponse);
  rpc ListChainIds (ListChainIdsRequest) returns (ListChainIdsResponse);
  rpc ListKeys (ListKeysRequest) returns (ListKeysResponse);
  rpc SetOwner (SetOwnerRequest) returns (SetOwnerResponse);
  rpc SetData (SetDataRequest) returns (SetDataResponse);
  rpc Resolve (ResolveRequest) returns (ResolveResponse);
  rpc EstablishCoin (EstablishCoinRequest) returns (EstablishCoinResponse);
  rpc MintCoin (MintCoinRequest) returns (MintCoinResponse);
}
